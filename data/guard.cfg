#textdomain wesnoth-Creep_Wars

#undef CWD_ITEMS_GUARD_DEFAULT
#define CWD_ITEMS_GUARD_DEFAULT
	number_can_own=1000
#enddef


#undef CWD_ITEMS_GUARD_INIT
#define CWD_ITEMS_GUARD_INIT
[set_variables]
	name=cw_items.guard
	mode=append
	{CWD_ITEMS_GUARD_HEAL 1}
	{CWD_ITEMS_GUARD_HEAL 2}
	{CWD_ITEMS_GUARD_CURE 1}
	{CWD_ITEMS_GUARD_CURE 2}
[/set_variables]
{VARIABLE cw_items.guard.max_number 1000}
{VARIABLE cw_items.guard.menu_image "units/human-loyalists/lieutenant.png"}
{VARIABLE cw_items.guard.title (_ "$cw_text.heal $cw_text.guard")}
{CWD_ARRAY_APPEND cw_items.types (name=guard)}
[set_variables]
	name=cw_items.guard.pre_class_execute
	[literal]
		{CWD_GET_TEAM_FROM_SIDE cw_guard_team $side_number}
		{CWD_FIRE cw_event_get_unit_status (
		id=cw_unit_guard_$cw_guard_team|1
		damaged=cw_guard_1_damaged
		poisoned=cw_guard_1_poisoned
		)}
		{CWD_FIRE cw_event_get_unit_status (
		id=cw_unit_guard_$cw_guard_team|2
		damaged=cw_guard_2_damaged
		poisoned=cw_guard_2_poisoned
		)}
		{VARIABLE tmp_msg "$tmp_msg|
$cw_text.times| $cw_shop.$side_number|.guard.1.name| $cw_text.healed_guard|: $cw_guard.$cw_guard_team|.1.healed|
$cw_text.times| $cw_shop.$side_number|.guard.2.name| $cw_text.healed_guard|: $cw_guard.$cw_guard_team|.2.healed|"}
		[/literal]
	[/set_variables]
[set_variables]
	name=cw_items.guard.cleanup
	[literal]
		{CLEAR_VARIABLE cw_guard_1_damaged,cw_guard_1_poisoned,cw_guard_2_damaged,cw_guard_2_poisoned,cw_guard_1_heal_hp,cw_guard_2_heal_hp,cw_guard_team}
		[/literal]
	[/set_variables]
#enddef


#undef CWD_ITEMS_GUARD_HEAL
#define CWD_ITEMS_GUARD_HEAL GUARD_NUM
[literal]
	uid="{GUARD_NUM}gh"
	name="$cw_text.heal_guard 40%: $cw_shop.$side_number|.guard.{GUARD_NUM}.name" 
	{CWD_ITEMS_GUARD_DEFAULT}
	subtype=heal
	image="icons/potion_red_small.png"
	base_price=13
	scale_price=22
	description="$cw_text.heal $cw_guard_{GUARD_NUM}_heal_hp $cw_text.hp"
	[pre_item_display]
		{STORE_UNIT_VAR (id=cw_unit_guard_$cw_guard_team|{GUARD_NUM}) max_hitpoints cw_guard_{GUARD_NUM}_heal_hp}
		{VARIABLE_OP cw_guard_{GUARD_NUM}_heal_hp multiply 0.4}
		{VARIABLE i_surcharge $cw_guard.$cw_guard_team|.{GUARD_NUM}.healed}
		{VARIABLE_OP i_surcharge multiply $cw_items.guard[$i].scale_price}
		{VARIABLE_OP cw_items.guard[$i].price add $i_surcharge}
		{CLEAR_VARIABLE i_surcharge}
		{VARIABLE b_item_is_needed $cw_guard_{GUARD_NUM}_damaged}
		[/pre_item_display]
	[upon_purchase]
		[object]
			silent=yes
			[filter]
				id=cw_unit_guard_$cw_guard_team|{GUARD_NUM}
				[/filter]
			[effect]
				apply_to=hitpoints
				increase=$cw_guard_{GUARD_NUM}_heal_hp
				[/effect]
			[/object]
		{VARIABLE_OP cw_guard.$cw_guard_team|.{GUARD_NUM}.healed add 1}
		[/upon_purchase]
	[/literal]
#enddef

#undef CWD_ITEMS_GUARD_CURE
#define CWD_ITEMS_GUARD_CURE GUARD_NUM
[literal]
	uid="{GUARD_NUM}gc"
	name="$cw_text.cure_guard|: $cw_shop.$side_number|.guard.{GUARD_NUM}.name" 
	{CWD_ITEMS_GUARD_DEFAULT}
	subtype=cure
	image="icons/potion_green_small.png"
	base_price=16
	[upon_purchase]
		[object]
			silent=yes
			[filter]
				id=cw_unit_guard_$cw_guard_team|{GUARD_NUM}
				[/filter]
			{CWD_EFFECT_CURE}
			[/object]
		[/upon_purchase]
	[pre_item_display]
		{VARIABLE b_item_is_needed $cw_guard_{GUARD_NUM}_poisoned}
		[/pre_item_display]
	[/literal]
#enddef
